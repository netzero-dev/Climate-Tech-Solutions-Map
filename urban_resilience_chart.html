<!DOCTYPE html>
<html>
<head>
    <title>Climate Adaptation Solutions Sunburst</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.24.1/plotly.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        #chart { width: 1200px; height: 800px; margin: 0 auto; }
    </style>
</head>
<body>
    <div id="chart"></div>

    <script>
        async function createVisualization() {
            const response = await fetch('https://netzero-dev.github.io/Climate-Tech-Solutions-Map/climate_adaptation_solutions_full.csv');
            const csvText = await response.text();
            
            const rawData = Papa.parse(csvText, {
                header: true,
                skipEmptyLines: true
            }).data;

            // Get unique categories
            const categories = [...new Set(rawData.map(d => d.Category))];
            
            // Create data arrays
            const labels = [...categories];  // Start with categories
            const parents = Array(categories.length).fill('');  // Categories have no parent
            const values = Array(categories.length).fill(1);    // Equal weight for categories

            // Add solutions
            rawData.forEach(row => {
                if (row.Category && row.Solution_Name) {
                    labels.push(row.Solution_Name);
                    parents.push(row.Category);
                    values.push(1);
                }
            });

            const data = [{
                type: 'sunburst',
                labels: labels,
                parents: parents,
                values: values,
                branchvalues: 'total'
            }];

            const layout = {
                title: 'Climate Adaptation Solutions',
                width: 1200,
                height: 800
            };

            Plotly.newPlot('chart', data, layout);
        }

        createVisualization().catch(console.error);
    </script>
</body>
</html>